<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
</head>

<body>

<script type="module">
	import * as THREE from '../build/three.module.js';
	import { OrbitControls } from './jsm/controls/OrbitControls.js';
	import {FirstPersonControls} from "./jsm/controls/FirstPersonControls.js";
	import { GLTFLoader } from './jsm/loaders/GLTFLoader.js';
	import { RGBELoader } from './jsm/loaders/RGBELoader.js';

	let camera, scene, renderer ,controls;
	const clock = new THREE.Clock();
	init();

	function init() {
		const container = document.createElement( 'div' );
		document.body.appendChild( container );
		renderer = new THREE.WebGLRenderer( { antialias: true } );
		renderer.setPixelRatio( window.devicePixelRatio );
		renderer.setSize( window.innerWidth, window.innerHeight );
		renderer.outputEncoding = THREE.sRGBEncoding;
		container.appendChild( renderer.domElement );
		scene = new THREE.Scene();
		const light1 = new THREE.PointLight( 0xffffff, 1, 0 );
		light1.position.set( 0, 100, 0 );
		scene.add( light1 );

		const envLoader= new RGBELoader().setPath('textures/equirectangular/')
				.load( 'pedestrian_overpass_1k.hdr', texture => {
					texture.mapping = THREE.EquirectangularReflectionMapping;
					scene.background = texture;
					scene.environment = texture;
				});

		const loader = new GLTFLoader().setPath('../porshe/');
		loader.load( 'scene.gltf',
				gltf  => {
					scene.add(gltf.scene)
				}
		);

		camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.25, 20 );
		camera.position.set( - 1.8, 0.6, 2.7 );
		controls=  new FirstPersonControls(camera,renderer.domElement );
		controls.lookSpeed = 0.1;
		controls.movementSpeed = 5;

		window.addEventListener( 'resize', onWindowResize );
		renderer.setAnimationLoop(render);
	}

	function onWindowResize() {
		camera.aspect = window.innerWidth / window.innerHeight;
		camera.updateProjectionMatrix();
		renderer.setSize( window.innerWidth, window.innerHeight );
		controls.handleResize();
	}

	function render() {
		controls.update(clock.getDelta());
		renderer.render( scene, camera );
	}



</script>

</body>
</html>
